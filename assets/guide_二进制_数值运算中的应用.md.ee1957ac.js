import{_ as s,o as a,c as n,Q as p}from"./chunks/framework.b6910bb2.js";const b=JSON.parse('{"title":"背景","description":"","frontmatter":{"theme":"condensed-night-purple","highlight":"vs2015"},"headers":[],"relativePath":"guide/二进制/数值运算中的应用.md","filePath":"guide/二进制/数值运算中的应用.md","lastUpdated":1765419480000}'),l={name:"guide/二进制/数值运算中的应用.md"},o=p(`<p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/eda2d8191de4447e9fbf4cac7d942cac~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=forWEDDEjFc6M2mhupLcVhV7uR0%3D" alt="微信图片202510302307291449.jpg"></p><h1 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h1><p>在最近的项目开发中，遇到了许多与二进制相关的问题，比如：</p><ul><li>接口返回的 long 型数据精度丢失；</li><li>浮点数计算误差（如 0.1 + 0.2 ≠ 0.3）；</li><li>大整数运算或文件数据转化。</li></ul><p>这些问题的本质，都离不开对 <strong>计算机底层二进制表示与运算规则</strong> 的理解。</p><p>基于此，这篇文章将讲解二进制的常见表示与运算法则，并结合项目中的实际案例，一步步剖析这些看似“神秘”的问题。</p><h1 id="基础知识" tabindex="-1">基础知识 <a class="header-anchor" href="#基础知识" aria-label="Permalink to &quot;基础知识&quot;">​</a></h1><h2 id="计算机中的数据" tabindex="-1">计算机中的数据 <a class="header-anchor" href="#计算机中的数据" aria-label="Permalink to &quot;计算机中的数据&quot;">​</a></h2><p>在计算机中，所有数据本质上都是由二进制（0 和 1）组成的。大体可以分为：</p><ul><li><strong>数值数据</strong>：无符号数据、有符号数据等；</li><li><strong>非数值数据</strong>：字符、图像、音频等。</li></ul><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/b761465f90ed447f88e27f7f064a53f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=qZIoLOKNbWejfEFIn%2F4c0o3IfAk%3D" alt="image.png"></p><h3 id="数值数据" tabindex="-1">数值数据 <a class="header-anchor" href="#数值数据" aria-label="Permalink to &quot;数值数据&quot;">​</a></h3><h4 id="无符号数据" tabindex="-1">无符号数据 <a class="header-anchor" href="#无符号数据" aria-label="Permalink to &quot;无符号数据&quot;">​</a></h4><p>在二进制中，无符号数据通过 0、1 表示。</p><p>例如 3 个 bit 能表示 8 个数 (0、1、2、3、4、5、6、7)</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/9442fd3b15974625aeef9f5e465bf53f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=h6YqmGqIrvckt2ZEzM%2FOxCkPKAM%3D" alt="image.png"></p><h4 id="有符号数据" tabindex="-1">有符号数据 <a class="header-anchor" href="#有符号数据" aria-label="Permalink to &quot;有符号数据&quot;">​</a></h4><p>而有符号数据，则最高位通过 0、1表示正符号（0 是正数、1是负数）</p><p>例如 3 个 bit 能表示 8 个数 (+0、+1、+2、+3、-3、-2、-1、-0)</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/bcdd75306fba4efc96d46e1dd619f8e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=zxHiWvzg%2BSz1lzEUL4XEgeD0qVg%3D" alt="image.png"></p><h4 id="从反码到补码-计算机如何做减法" tabindex="-1">从反码到补码：计算机如何做减法 <a class="header-anchor" href="#从反码到补码-计算机如何做减法" aria-label="Permalink to &quot;从反码到补码：计算机如何做减法&quot;">​</a></h4><p>在二进制中，做加法非常简单，但“减法”其实是通过 <strong>加上补码</strong> 实现的。</p><p>例如 010 + 001 = 011 即 2 + 1 = 3，可当我需要做减法运算呢？</p><p>聪明的同学可能已经到了那就加上一个数的负数即可，例如 2 - 1 = 2 +（-1）= 1;</p><p>可当我们尝试进行运算时会发现 010 + 101 = 111（-3）显然答案是错误的。</p><p>那需要怎么做呢？</p><p>答案是在 二进制中 <strong>减去一个数</strong> 等于 <strong>加上一个数的补码</strong></p><p>在了解补码之前，我们需要先了解什么是 <strong>反码</strong></p><h5 id="反码" tabindex="-1">反码 <a class="header-anchor" href="#反码" aria-label="Permalink to &quot;反码&quot;">​</a></h5><p>反码指的是 正数不变，负数除符号位取反</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/b639e8202bc94bc3a693c85addc614db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=cmzANzyDKlpHkwOlVoiVaBaEDBI%3D" alt="image.png"></p><p>这时候有同学可能已经发现了规律，如下图所示</p><p><strong>当正数的二进制每一位的取反后，就是他对应的负数，这就相当于在二进制中，减去一个数，相当于加上一个二进制数的反码。</strong></p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/e2f8d983a9724259b890631a490e6f3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=IWp5IdrwZ%2BfDStrH5r2XG4FKKkw%3D" alt="image.png"></p><p>但反码中存在的缺点：0 存在着 2 种表示方法（+0、-0），但对于 0 来说，存在一种就可以了，没什么区别。</p><p>为了解决反码的缺点，补码就顺势而出了。</p><h5 id="补码" tabindex="-1">补码 <a class="header-anchor" href="#补码" aria-label="Permalink to &quot;补码&quot;">​</a></h5><p>正数不变，负数在反码的基础上加 1</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/bf61587b882a4db79178c79bc6bb3085~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=NE0VYa6%2FVKrnkfh7seaKPEWGsI4%3D" alt="image.png"></p><p>通过补码，在表示数量不变的基础上，解决了反码中存在 +0、-0 的冗余表示方法。</p><p>例如 010 - 001 =&gt; 010 + 111(补码) = 001</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/56ebc04a055b4ba3bb80ed7d0a953c96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=diVuPanzr4f7bPaxmtOd1gMwJUI%3D" alt="image.png"></p><h2 id="进制转化" tabindex="-1">进制转化 <a class="header-anchor" href="#进制转化" aria-label="Permalink to &quot;进制转化&quot;">​</a></h2><h3 id="二进制转十进制" tabindex="-1">二进制转十进制 <a class="header-anchor" href="#二进制转十进制" aria-label="Permalink to &quot;二进制转十进制&quot;">​</a></h3><p>以二进制 111.11 为例子</p><p>二进制转十进制的核心是 <strong>按位加权求和</strong> ，即每个数位上的数字乘以 2 的对应幂次，然后将所有结果相加。整数部分和小数部分的计算规则略有不同，需分开处理。</p><h4 id="_1-整数部分计算-111" tabindex="-1">1. 整数部分计算（111） <a class="header-anchor" href="#_1-整数部分计算-111" aria-label="Permalink to &quot;1. 整数部分计算（111）&quot;">​</a></h4><p>整数部分从右往左，幂次从 0 开始依次递增。</p><ul><li>最右侧第 1 位（1）：$1 × 2⁰ = 1 × 1 = 1$</li><li>中间第 2 位（1）：$1 × 2¹ = 1 × 2 = 2$</li><li>最左侧第 3 位（1）：$1 × 2² = 1 × 4 = 4$</li><li>整数部分总和：$1 + 2 + 4 = 7$</li></ul><h4 id="_2-小数部分计算-11" tabindex="-1">2. 小数部分计算（.11） <a class="header-anchor" href="#_2-小数部分计算-11" aria-label="Permalink to &quot;2. 小数部分计算（.11）&quot;">​</a></h4><p>小数部分从左往右，幂次从 - 1 开始依次递减。</p><ul><li>小数点后第 1 位（1）：$1 × 2⁻¹ = 1 × 0.5 = 0.5$</li><li>小数点后第 2 位（1）：$1 × 2⁻² = 1 × 0.25 = 0.25$</li><li>小数部分总和：$0.5 + 0.25 = 0.75$</li></ul><h4 id="_3-最终结果" tabindex="-1">3. 最终结果 <a class="header-anchor" href="#_3-最终结果" aria-label="Permalink to &quot;3. 最终结果&quot;">​</a></h4><p>将整数部分和小数部分相加，得到最终十进制结果：7 + 0.75 = <strong>7.75</strong></p><h3 id="十进制转二进制" tabindex="-1">十进制转二进制 <a class="header-anchor" href="#十进制转二进制" aria-label="Permalink to &quot;十进制转二进制&quot;">​</a></h3><p><strong>整数部分:</strong> 除 2 取余，直到商为 0。最先得到的余数是最低位，最后得到的余数是最高位。</p><p><strong>小数部分:</strong> 乘 2 取整，直到积为 0 或者达到精度要求为止。最先得到的是整数最高位</p><p>例如 十进制中的 7.75 可以转化为 二进制的 111.11</p><p>整数部分是 111 <img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/ed0a619660c04c48b9165cb5209b15a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=kfF5NzpndFfiegRaxsy8rHNtlu8%3D" alt="image.png"></p><p>小数部分是 0.11 因此，十进制中的 7.75 是 二进制中的 111.11</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/76c32fca096f49a9ab9e526aad1b9109~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=2RvBemSLPXIgHo00CZU%2BRiszOys%3D" alt="image.png"></p><h2 id="ieee754-标准" tabindex="-1">IEEE754 标准 <a class="header-anchor" href="#ieee754-标准" aria-label="Permalink to &quot;IEEE754 标准&quot;">​</a></h2><p>JavaScript 采用 IEEE 754 双精度标准，用 64 位存储一个数字，结构分为三部分：</p><ul><li><strong>符号位（1 位）</strong> ：表示正负，0 为正，1 为负。</li><li><strong>指数位（11 位）</strong> ：决定数值的数量级。</li><li><strong>小数有效位（52 位）</strong> ：决定数值的精度，也称为 “尾数”。</li></ul><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/5b51b6540746464fb96a5356d00b98f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=42TLpPFPBZcFkZ6HMkANUKwL2TI%3D" alt="image.png"></p><p>在浮点数的科学计数法表示中</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/169408c2bcd24556b84da07581ca27af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=1pld1LjdMIRpCpnpfNJMULxDTB8%3D" alt="image.png"></p><p>例如 $十进制中的 3.5 = 二进制中的 11.1 = 1.11 * 2^1$</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/18358ce8e32341c88965c9ea205f2626~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=Uhi8qsnHA0fYLQjVo0ePidAoj5Y%3D" alt="image.png"></p><h3 id="最大精度" tabindex="-1">最大精度 <a class="header-anchor" href="#最大精度" aria-label="Permalink to &quot;最大精度&quot;">​</a></h3><p><strong>小数有效位是 “隐含了一位前导 1” 的</strong>。也就是说，52 位的小数有效位实际能表示 52+1=53 位二进制精度。</p><p>因此，它能精确表示的最大整数就是 2⁵³ - 1（因为 53 位二进制数的最大值是 “53 个 1”，即 2⁵³ - 1）。如果整数超过这个值，JavaScript 就无法保证精确存储和计算了。</p><h1 id="实战案例" tabindex="-1">实战案例 <a class="header-anchor" href="#实战案例" aria-label="Permalink to &quot;实战案例&quot;">​</a></h1><p>讲述完相对枯燥的基础知识后，接下来到了相对有趣的项目实战中遇到的案例进行分析。</p><h2 id="案例-1-接口返回的-long-类型被-改写" tabindex="-1">案例 1：接口返回的 long 类型被 “改写” <a class="header-anchor" href="#案例-1-接口返回的-long-类型被-改写" aria-label="Permalink to &quot;案例 1：接口返回的 long 类型被 “改写”&quot;">​</a></h2><p>某天, 前端小C和后端小Q 在对接接口的时候, 数据明明返回的是long类型 1981543253761712129, 可浏览器显示的却是 1981543253761712000</p><p>但这一切瞒不过刚学过 IEEE754 标准的小 C, 小 C 灵光一闪，因为 JavaScript 中最大整数是 2⁵³ - 1 （即 9007199254740991）</p><p>而输入的 <code>1981543253761712129</code>，该数字的二进制位数超过 53 位，尾数位（52 位 + 隐藏位 1 位）无法完整存储所有有效数字，JavaScript 会自动舍入，保留最接近的可表示值，导致末尾的 <code>129</code> 被舍去，使用偏移量补零为 <code>000</code>，最终结果为 <code>1981543253761712000</code>。</p><p>也可以在控制台输入 1981543253761712129 也会被丢弃转化为 1981543253761712000</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/0a7e8bbc4f6c41babad1012681760294~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=LpaU9k2fGfe6E7EujAJLxHiA3Tg%3D" alt="image.png"></p><h2 id="案例-2-0-1-0-2-0-3" tabindex="-1">案例 2：<code>0.1 + 0.2 !== 0.3</code> <a class="header-anchor" href="#案例-2-0-1-0-2-0-3" aria-label="Permalink to &quot;案例 2：\`0.1 + 0.2 !== 0.3\`&quot;">​</a></h2><p>0.1 通过 <strong>乘2取整法</strong> 转化为 二进制过程中，存在着 无限循环小数 <img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/50037523c8014f0695b1019de2e14e3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=BbYw5hzNR1m81E3uBDmGCXV1jhM%3D" alt="image.png"></p><p>而 0.2 也存在着 无限循环小数</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/7bd54edfbaa9485bbbb6be663dd3f050~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=wbOQpbUFP67qg8bQ%2B1SoYCMxryk%3D" alt="image.png"></p><p>同理 0.3 也是存在着无限循环小数。</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/6ec38677684043149ab41e1f099ecef3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=9hMZcvsfI5SA9zuhuzZgYoOKiOo%3D" alt="image.png"></p><p>因此，在二进制中，0.1 + 0.2 != 0.3</p><p>解决方法也有特别多，常见的是通过 toFixed 方法进行精度截取。</p><p><img src="https://p0-xtjj-private.juejin.cn/tos-cn-i-73owjymdk6/2d0cfadf07af40308a0005c2f21d668b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bem6ICz5ZKa:q75.awebp?policy=eyJ2bSI6MywidWlkIjoiMzU0NDQ4MTIxODQzNTU0OSJ9&amp;rk3s=f64ab15b&amp;x-orig-authkey=f32326d3454f2ac7e96d3d06cdbb035152127018&amp;x-orig-expires=1763049968&amp;x-orig-sign=PRjej3dj4Xu6PIlp8VOeone4UEQ%3D" alt="image.png"></p><h2 id="案例-3-大整数加法-前端高精度计算" tabindex="-1">案例 3：大整数加法（前端高精度计算） <a class="header-anchor" href="#案例-3-大整数加法-前端高精度计算" aria-label="Permalink to &quot;案例 3：大整数加法（前端高精度计算）&quot;">​</a></h2><p>在支付平台/钱包业务中，比较常见的就是大整数加法了, 常见的解法有双指针解法等等。。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">// 双指针解法</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">lagerPhoneNumber</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">number1</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">number2</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 确保number1是最小数</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (number1.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> number2.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      [number1, number2] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [number2, number1];</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> number1.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">len2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> number2.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// number1的指针</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> j </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// number2的指针</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// 权重</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> len1) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">=</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">Number</span><span style="color:#E1E4E8;">(number1[len1 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> i]) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Number</span><span style="color:#E1E4E8;">(number2[len2 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> j]) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> povit;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (num </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        num </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// 重置</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> res;</span></span>
<span class="line"><span style="color:#E1E4E8;">      i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">      j</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 最后考虑number2的情况</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">while</span><span style="color:#E1E4E8;"> (j </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> len2) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Number</span><span style="color:#E1E4E8;">(number2[len2 </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> j]) </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> povit;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (num </span><span style="color:#F97583;">&gt;=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        num </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">      } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// 重置</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> num </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> res;</span></span>
<span class="line"><span style="color:#E1E4E8;">      j</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (povit) {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 最后一种情况</span></span>
<span class="line"><span style="color:#E1E4E8;">      res </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> res;</span></span>
<span class="line"><span style="color:#E1E4E8;">      povit </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> res;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// 双指针解法</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">lagerPhoneNumber</span><span style="color:#24292E;">(</span><span style="color:#E36209;">number1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">number2</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 确保number1是最小数</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (number1.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> number2.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">      [number1, number2] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [number2, number1];</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> number1.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">len2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> number2.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// number1的指针</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> j </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// number2的指针</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// 权重</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> len1) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">Number</span><span style="color:#24292E;">(number1[len1 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> i]) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Number</span><span style="color:#24292E;">(number2[len2 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> j]) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> povit;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (num </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        num </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// 重置</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> res;</span></span>
<span class="line"><span style="color:#24292E;">      i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">      j</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// 最后考虑number2的情况</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">while</span><span style="color:#24292E;"> (j </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> len2) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Number</span><span style="color:#24292E;">(number2[len2 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> j]) </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> povit;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (num </span><span style="color:#D73A49;">&gt;=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        num </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// 重置</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> num </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> res;</span></span>
<span class="line"><span style="color:#24292E;">      j</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (povit) {</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">// 最后一种情况</span></span>
<span class="line"><span style="color:#24292E;">      res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> res;</span></span>
<span class="line"><span style="color:#24292E;">      povit </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> res;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span></code></pre></div><h1 id="最后" tabindex="-1">最后 <a class="header-anchor" href="#最后" aria-label="Permalink to &quot;最后&quot;">​</a></h1><p>二进制、补码、IEEE754 这些概念看似“底层”，但在平时项目开发中影响巨大。<br> 理解这些原理，能帮助我们在面对数据精度问题时，不再只是 “试出来”，而是 “看得懂、解释清、能修复”。</p>`,94),e=[o];function r(t,c,y,E,i,m){return a(),n("div",null,e)}const g=s(l,[["render",r]]);export{b as __pageData,g as default};
