import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.b6910bb2.js";const p="/vitePress-blob/assets/12.31e4f330.gif",D=JSON.parse('{"title":"é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜ Canvas ä¹¦å†™æ€§èƒ½","description":"","frontmatter":{},"headers":[],"relativePath":"guide/canvas/é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜Canvasä¹¦å†™æ€§èƒ½.md","filePath":"guide/canvas/é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜Canvasä¹¦å†™æ€§èƒ½.md","lastUpdated":1706754379000}'),o={name:"guide/canvas/é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜Canvasä¹¦å†™æ€§èƒ½.md"},e=l(`<h1 id="é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜-canvas-ä¹¦å†™æ€§èƒ½" tabindex="-1">é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜ Canvas ä¹¦å†™æ€§èƒ½ <a class="header-anchor" href="#é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜-canvas-ä¹¦å†™æ€§èƒ½" aria-label="Permalink to &quot;é€šè¿‡ç¦»å±æ¸²æŸ“æé«˜ Canvas ä¹¦å†™æ€§èƒ½&quot;">â€‹</a></h1><h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-label="Permalink to &quot;å‰è¨€&quot;">â€‹</a></h2><p>å‰é¢æˆ‘ä»¬é€šè¿‡ä¸Šä¸‹åˆ†å±‚çš„æ–¹å¼ï¼Œä¼˜åŒ–äº† Canvas çš„ä¹¦å†™æ€§èƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡ç¦»å±æ¸²æŸ“çš„æ–¹å¼ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ– Canvas çš„ä¹¦å†™æ€§èƒ½ã€‚</p><h2 id="åŸºæœ¬æ€è·¯" tabindex="-1">åŸºæœ¬æ€è·¯ <a class="header-anchor" href="#åŸºæœ¬æ€è·¯" aria-label="Permalink to &quot;åŸºæœ¬æ€è·¯&quot;">â€‹</a></h2><p>åœ¨ä¹¦å†™çš„è¿‡ç¨‹ä¸­ï¼Œæ¯ç»˜åˆ¶ä¸€ç¬”éƒ½éœ€è¦ä¸æ–­åœ°è°ƒç”¨ Canvas çš„ APIï¼Œé‡æ–°æ¸²æŸ“æ•´ä¸ª Canvasï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´æ€§èƒ½çš„æµªè´¹ã€‚ è€Œç¦»å±æ¸²æŸ“åˆ™æ˜¯å°† ç»˜åˆ¶å†…å®¹å­˜å‚¨åˆ°ç¦»å±çš„ Canvas ä¸­ï¼Œç›¸å½“äºä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åå°†éœ€è¦ç»˜åˆ¶çš„ç”»é¢åœ¨ç¦»å±çš„ Canvas ç¼“å†²å¥½ï¼Œæœ€åå°†ç¦»å±çš„ Canvas è½¬åŒ–æˆå›¾ç‰‡ï¼Œæ¸²æŸ“åˆ°å±å¹•ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„ã€‚</p><h2 id="å®ç°" tabindex="-1">å®ç° <a class="header-anchor" href="#å®ç°" aria-label="Permalink to &quot;å®ç°&quot;">â€‹</a></h2><h3 id="åˆ›å»ºç¦»å±-canvas" tabindex="-1">åˆ›å»ºç¦»å± Canvas <a class="header-anchor" href="#åˆ›å»ºç¦»å±-canvas" aria-label="Permalink to &quot;åˆ›å»ºç¦»å± Canvas&quot;">â€‹</a></h3><p>æ€è·¯å¦‚ä¸‹: åŸºäºä¸Šä¸€èŠ‚çš„åŸºç¡€ï¼Œæˆ‘ä»¬æ”¹å†™ render å‡½æ•°ï¼Œå¦‚æœæ˜¯ç¦»å±æ¸²æŸ“çš„è¯ï¼Œå°†ç»˜åˆ¶çš„å†…å®¹å­˜å‚¨åˆ°ç¦»å±çš„ Canvas ä¸­ï¼Œç„¶åå°†ç¦»å±çš„ Canvas ç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡ç»˜åˆ¶çš„æ—¶å€™ï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜çš„è¯ï¼Œå°±ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„ Canvasï¼Œä»è€Œè¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„ã€‚</p><p>æ“ä½œå¦‚ä¸‹:</p><ul><li>1 åœ¨æ‰§è¡Œ render å‡½æ•°ä¹‹å‰ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¼“å­˜çš„ Canvasï¼Œå¦‚æœå­˜åœ¨çš„è¯ï¼Œå°±ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„ Canvas</li><li>2 å¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œä½¿ç”¨ç¦»å± Canvas è½¬åŒ–æˆå›¾ç‰‡è¿›è¡Œç»˜åˆ¶</li><li>3 å¦‚æœä¸å­˜åœ¨ç¼“å­˜çš„ Canvasï¼Œå°±åˆ›å»ºä¸€ä¸ªç¦»å±çš„ Canvasï¼Œç„¶åå°†ç»˜åˆ¶çš„å†…å®¹å­˜å‚¨åˆ°ç¦»å±çš„ Canvas ä¸­ï¼Œæœ€åå°†ç¦»å±çš„ Canvas ç¼“å­˜èµ·æ¥</li></ul><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">elementWithCanvasCache</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">WeakMap</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// ç”¨äºå­˜å‚¨ç¦»å± Canvas çš„ç¼“å­˜</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">generateOffScreenCanvas</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">padding</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// é¿å…ç¬”è®°è¢« Canvas </span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">canvas</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">createElement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;canvas&#39;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// åˆ›å»ºä¸€ä¸ªç¦»å± Canvas</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ctxContent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> canvas.</span><span style="color:#B392F0;">getContext</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;2d&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// TODO ç»˜åˆ¶çš„å†…å®¹å­˜å‚¨</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// ....</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// å°†ç¦»å± Canvas ç¼“å­˜èµ·æ¥</span></span>
<span class="line"><span style="color:#E1E4E8;">            elementWithCanvasCache.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(points, {</span></span>
<span class="line"><span style="color:#E1E4E8;">                canvas,</span></span>
<span class="line"><span style="color:#E1E4E8;">            });</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> canvas;</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * ç»˜åˆ¶å‡½æ•°</span></span>
<span class="line"><span style="color:#6A737D;">         * @param {*} ctx - canvas å°ºå¯¸</span></span>
<span class="line"><span style="color:#6A737D;">         * @param {*} points - é¼ æ ‡ç§»åŠ¨çš„ç‚¹é›†</span></span>
<span class="line"><span style="color:#6A737D;">         * @return è¿”å›ä¸€ä¸ª canvas å…ƒç´ </span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">render</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ctx</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">isOffScreen</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">              åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¼“å­˜å…ƒç´ ï¼Œå­˜åœ¨çš„è¯ä½¿ç”¨ç¼“å­˜å…ƒç´ ï¼Œç»˜åˆ¶</span></span>
<span class="line"><span style="color:#6A737D;">            */</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (isOffScreen </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> elementWithCanvasCache.</span><span style="color:#B392F0;">has</span><span style="color:#E1E4E8;">(points)) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">canvas</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">x</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">y</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">width</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">height</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> elementWithCanvasCache.</span><span style="color:#B392F0;">get</span><span style="color:#E1E4E8;">(points);</span></span>
<span class="line"><span style="color:#E1E4E8;">                ctx.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                ctx.</span><span style="color:#B392F0;">scale</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> dpr, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> dpr);</span></span>
<span class="line"><span style="color:#E1E4E8;">                ctx.</span><span style="color:#B392F0;">drawImage</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">                    canvas,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    x,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    y,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    canvas.width,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    canvas.height</span></span>
<span class="line"><span style="color:#E1E4E8;">                );</span></span>
<span class="line"><span style="color:#E1E4E8;">                ctx.</span><span style="color:#B392F0;">restore</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">                console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`å‘½ä¸­äº†ğŸ¯\`</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.strokeStyle </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;red&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡é¢œè‰²</span></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.lineWidth </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡å®½åº¦</span></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.lineJoin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;round&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡è¿æ¥å¤„çš„æ ·å¼</span></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.lineCap </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;round&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡æœ«ç«¯çš„æ ·å¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">            beginPath() æ˜¯ Canvas 2D API ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå¼€å§‹ä¸€ä¸ªæ–°çš„è·¯å¾„ã€‚å½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„è·¯å¾„æ—¶ï¼Œä½ éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">            ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨å®ƒï¼š</span></span>
<span class="line"><span style="color:#6A737D;">                context.beginPath();</span></span>
<span class="line"><span style="color:#6A737D;">                context.moveTo(50, 50);</span></span>
<span class="line"><span style="color:#6A737D;">                context.lineTo(200, 50);</span></span>
<span class="line"><span style="color:#6A737D;">                context.stroke();</span></span>
<span class="line"><span style="color:#6A737D;">                åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒbeginPath() å¼€å§‹ä¸€ä¸ªæ–°çš„è·¯å¾„ï¼ŒmoveTo(50, 50) å°†è·¯å¾„çš„èµ·ç‚¹ç§»åŠ¨åˆ° (50, 50)ï¼ŒlineTo(200, 50) æ·»åŠ ä¸€æ¡ä»å½“å‰ä½ç½®åˆ° (200, 50) çš„çº¿ï¼Œ</span></span>
<span class="line"><span style="color:#6A737D;">                æœ€å stroke() æ–¹æ³•ç»˜åˆ¶å‡ºè·¯å¾„ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">                å…¶ä¸­ context æ˜¯ä½ çš„ canvas ä¸Šä¸‹æ–‡ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">            */</span></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.</span><span style="color:#B392F0;">beginPath</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// å¼€å§‹ç»˜åˆ¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.</span><span style="color:#B392F0;">moveTo</span><span style="color:#E1E4E8;">(points[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">].x, points[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">].y); </span><span style="color:#6A737D;">// å°†ç”»ç¬”ç§»åŠ¨åˆ°èµ·å§‹ç‚¹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> points.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">// å–ç»ˆç‚¹ï¼Œå°†ä¸Šä¸€ä¸ªç‚¹ä½œä¸ºæ§åˆ¶ç‚¹ï¼Œå¹³æ»‘è¿‡æ¸¡</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">cx</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (points[i].x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> points[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].x) </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">cy</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (points[i].y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> points[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].y) </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">                ctx.</span><span style="color:#B392F0;">quadraticCurveTo</span><span style="color:#E1E4E8;">(points[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].x, points[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].y, cx, cy);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            ctx.</span><span style="color:#B392F0;">stroke</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// ç»˜åˆ¶è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (isOffScreen) {</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#B392F0;">generateOffScreenCanvas</span><span style="color:#E1E4E8;">(points);</span></span>
<span class="line"><span style="color:#E1E4E8;">            }</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">   &lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">elementWithCanvasCache</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">WeakMap</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// ç”¨äºå­˜å‚¨ç¦»å± Canvas çš„ç¼“å­˜</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generateOffScreenCanvas</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">points</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">padding</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// é¿å…ç¬”è®°è¢« Canvas </span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">canvas</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;canvas&#39;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// åˆ›å»ºä¸€ä¸ªç¦»å± Canvas</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ctxContent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> canvas.</span><span style="color:#6F42C1;">getContext</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;2d&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">            </span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// TODO ç»˜åˆ¶çš„å†…å®¹å­˜å‚¨</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// ....</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// å°†ç¦»å± Canvas ç¼“å­˜èµ·æ¥</span></span>
<span class="line"><span style="color:#24292E;">            elementWithCanvasCache.</span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(points, {</span></span>
<span class="line"><span style="color:#24292E;">                canvas,</span></span>
<span class="line"><span style="color:#24292E;">            });</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> canvas;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;">         * ç»˜åˆ¶å‡½æ•°</span></span>
<span class="line"><span style="color:#6A737D;">         * @param {*} ctx - canvas å°ºå¯¸</span></span>
<span class="line"><span style="color:#6A737D;">         * @param {*} points - é¼ æ ‡ç§»åŠ¨çš„ç‚¹é›†</span></span>
<span class="line"><span style="color:#6A737D;">         * @return è¿”å›ä¸€ä¸ª canvas å…ƒç´ </span></span>
<span class="line"><span style="color:#6A737D;">         */</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">render</span><span style="color:#24292E;">(</span><span style="color:#E36209;">ctx</span><span style="color:#24292E;">, </span><span style="color:#E36209;">points</span><span style="color:#24292E;">, </span><span style="color:#E36209;">isOffScreen</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">              åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¼“å­˜å…ƒç´ ï¼Œå­˜åœ¨çš„è¯ä½¿ç”¨ç¼“å­˜å…ƒç´ ï¼Œç»˜åˆ¶</span></span>
<span class="line"><span style="color:#6A737D;">            */</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (isOffScreen </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> elementWithCanvasCache.</span><span style="color:#6F42C1;">has</span><span style="color:#24292E;">(points)) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">canvas</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">x</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">y</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">width</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">height</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> elementWithCanvasCache.</span><span style="color:#6F42C1;">get</span><span style="color:#24292E;">(points);</span></span>
<span class="line"><span style="color:#24292E;">                ctx.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                ctx.</span><span style="color:#6F42C1;">scale</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> dpr, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> dpr);</span></span>
<span class="line"><span style="color:#24292E;">                ctx.</span><span style="color:#6F42C1;">drawImage</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">                    canvas,</span></span>
<span class="line"><span style="color:#24292E;">                    x,</span></span>
<span class="line"><span style="color:#24292E;">                    y,</span></span>
<span class="line"><span style="color:#24292E;">                    canvas.width,</span></span>
<span class="line"><span style="color:#24292E;">                    canvas.height</span></span>
<span class="line"><span style="color:#24292E;">                );</span></span>
<span class="line"><span style="color:#24292E;">                ctx.</span><span style="color:#6F42C1;">restore</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">                console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`å‘½ä¸­äº†ğŸ¯\`</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">return</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            ctx.strokeStyle </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;red&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡é¢œè‰²</span></span>
<span class="line"><span style="color:#24292E;">            ctx.lineWidth </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡å®½åº¦</span></span>
<span class="line"><span style="color:#24292E;">            ctx.lineJoin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;round&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡è¿æ¥å¤„çš„æ ·å¼</span></span>
<span class="line"><span style="color:#24292E;">            ctx.lineCap </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;round&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡æœ«ç«¯çš„æ ·å¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">            beginPath() æ˜¯ Canvas 2D API ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå¼€å§‹ä¸€ä¸ªæ–°çš„è·¯å¾„ã€‚å½“ä½ æƒ³åˆ›å»ºä¸€ä¸ªæ–°çš„è·¯å¾„æ—¶ï¼Œä½ éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">            ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šè¿™æ ·ä½¿ç”¨å®ƒï¼š</span></span>
<span class="line"><span style="color:#6A737D;">                context.beginPath();</span></span>
<span class="line"><span style="color:#6A737D;">                context.moveTo(50, 50);</span></span>
<span class="line"><span style="color:#6A737D;">                context.lineTo(200, 50);</span></span>
<span class="line"><span style="color:#6A737D;">                context.stroke();</span></span>
<span class="line"><span style="color:#6A737D;">                åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒbeginPath() å¼€å§‹ä¸€ä¸ªæ–°çš„è·¯å¾„ï¼ŒmoveTo(50, 50) å°†è·¯å¾„çš„èµ·ç‚¹ç§»åŠ¨åˆ° (50, 50)ï¼ŒlineTo(200, 50) æ·»åŠ ä¸€æ¡ä»å½“å‰ä½ç½®åˆ° (200, 50) çš„çº¿ï¼Œ</span></span>
<span class="line"><span style="color:#6A737D;">                æœ€å stroke() æ–¹æ³•ç»˜åˆ¶å‡ºè·¯å¾„ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">                å…¶ä¸­ context æ˜¯ä½ çš„ canvas ä¸Šä¸‹æ–‡ã€‚</span></span>
<span class="line"><span style="color:#6A737D;">            */</span></span>
<span class="line"><span style="color:#24292E;">            ctx.</span><span style="color:#6F42C1;">beginPath</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// å¼€å§‹ç»˜åˆ¶</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            ctx.</span><span style="color:#6F42C1;">moveTo</span><span style="color:#24292E;">(points[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].x, points[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].y); </span><span style="color:#6A737D;">// å°†ç”»ç¬”ç§»åŠ¨åˆ°èµ·å§‹ç‚¹</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> points.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">// å–ç»ˆç‚¹ï¼Œå°†ä¸Šä¸€ä¸ªç‚¹ä½œä¸ºæ§åˆ¶ç‚¹ï¼Œå¹³æ»‘è¿‡æ¸¡</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cx</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (points[i].x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> points[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].x) </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cy</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (points[i].y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> points[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].y) </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">                ctx.</span><span style="color:#6F42C1;">quadraticCurveTo</span><span style="color:#24292E;">(points[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].x, points[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].y, cx, cy);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            ctx.</span><span style="color:#6F42C1;">stroke</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// ç»˜åˆ¶è·¯å¾„</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (isOffScreen) {</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6F42C1;">generateOffScreenCanvas</span><span style="color:#24292E;">(points);</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">   &lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h3 id="æ•°æ®çš„åˆ‡æ¢" tabindex="-1">æ•°æ®çš„åˆ‡æ¢ <a class="header-anchor" href="#æ•°æ®çš„åˆ‡æ¢" aria-label="Permalink to &quot;æ•°æ®çš„åˆ‡æ¢&quot;">â€‹</a></h3><p>è¿™é‡Œæ˜¯ç¦»å± Canvas çš„éš¾ç‚¹ï¼Œå³å¦‚ä½•å°†ç»˜åˆ¶çš„åæ ‡è½¬åŒ–åˆ°å¯¹åº”çš„ç¦»å± Canvas ä¸­ï¼Œè¿™é‡Œç¬”è€…é€šè¿‡è®¡ç®—åæ ‡çš„åç§»é‡ï¼Œå°†åæ ‡è½¬åŒ–åˆ°ç¦»å± Canvas ä¸­ã€‚ å³å…³é”®æ˜¯ <code>generateOffScreenCanvas</code> å‡½æ•°å¦‚ä½•å®ç°å°†ç»˜åˆ¶çš„å†…å®¹å­˜å‚¨åˆ°ç¦»å±çš„ Canvas ä¸­ã€‚</p><p>å®ç°æ€è·¯: 1 è·å–åˆ°ç»˜åˆ¶å›¾å½¢çš„æœ€å°çš„ç‚¹å’Œæœ€å¤§çš„ç‚¹ï¼Œä»è€Œè®¡ç®—å‡ºå®½é«˜ 2 è·å–æœ€å°çš„ç‚¹åæ ‡ï¼Œä»è€Œè®¡ç®—å‡ºç›¸å¯¹äºç¦»å± Canvas çš„åæ ‡é›†åˆ 3 å°†ç‚¹ç»˜åˆ¶åˆ°ç¦»å± Canvas ä¸­ 4 å°†ç¦»å± Canvas ç¼“å­˜èµ·æ¥ 5 å°†ç¦»å± Canvas è½¬åŒ–æˆå›¾ç‰‡è¿›è¡Œç»˜åˆ¶</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getBoundsFromPoints</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> minX </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Infinity</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> minY </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Infinity</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> maxX </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">Infinity</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> maxY </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">Infinity</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">x</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">y</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">of</span><span style="color:#E1E4E8;"> points) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            minX </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Math.</span><span style="color:#B392F0;">min</span><span style="color:#E1E4E8;">(minX, x);</span></span>
<span class="line"><span style="color:#E1E4E8;">            minY </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Math.</span><span style="color:#B392F0;">min</span><span style="color:#E1E4E8;">(minY, y);</span></span>
<span class="line"><span style="color:#E1E4E8;">            maxX </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Math.</span><span style="color:#B392F0;">max</span><span style="color:#E1E4E8;">(maxX, x);</span></span>
<span class="line"><span style="color:#E1E4E8;">            maxY </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Math.</span><span style="color:#B392F0;">max</span><span style="color:#E1E4E8;">(maxY, y);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> [minX, minY, maxX, maxY];</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">      1 è·å–å½“å‰å…ƒç´ çš„åæ ‡ï¼Œç›¸å¯¹äºç¦»å± Canvas çš„åæ ‡</span></span>
<span class="line"><span style="color:#6A737D;">      2 è·å– Canvas çš„å®½é«˜</span></span>
<span class="line"><span style="color:#6A737D;">      */</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getElementAbsoluteCoords</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> [</span><span style="color:#79B8FF;">minX</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">minY</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">maxX</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">maxY</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getBoundsFromPoints</span><span style="color:#E1E4E8;">(points);</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">width</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maxX </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> minX;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">height</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> maxY </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> minY;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">              minX,</span></span>
<span class="line"><span style="color:#E1E4E8;">              minY,</span></span>
<span class="line"><span style="color:#E1E4E8;">              width,</span></span>
<span class="line"><span style="color:#E1E4E8;">              height,</span></span>
<span class="line"><span style="color:#E1E4E8;">              points: points.</span><span style="color:#B392F0;">map</span><span style="color:#E1E4E8;">(({ </span><span style="color:#FFAB70;">x</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">y</span><span style="color:#E1E4E8;"> }) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> ({ x: Math.</span><span style="color:#B392F0;">round</span><span style="color:#E1E4E8;">(x </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> minX), y: Math.</span><span style="color:#B392F0;">round</span><span style="color:#E1E4E8;">(y </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> minY) })) </span><span style="color:#6A737D;">// è·å–å½“å‰å…ƒç´ çš„åæ ‡ï¼Œç›¸å¯¹äºç¦»å± Canvas çš„åæ ‡</span></span>
<span class="line"><span style="color:#E1E4E8;">          };</span></span>
<span class="line"><span style="color:#E1E4E8;">      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">generateOffScreenCanvas</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">canvas</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">createElement</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;canvas&#39;</span><span style="color:#E1E4E8;">); </span><span style="color:#6A737D;">// åˆ›å»ºä¸€ä¸ªç¦»å± Canvas</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ctxContent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> canvas.</span><span style="color:#B392F0;">getContext</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;2d&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">save</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">// è·å–æœ€å°çš„ç‚¹å’Œæœ€å¤§çš„ç‚¹</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">minX</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">minY</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">width</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">realWidth</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">height</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">realHeight</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">points</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">realPoints</span><span style="color:#E1E4E8;"> } </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">getElementAbsoluteCoords</span><span style="color:#E1E4E8;">(points);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">          console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`realWidth----&gt;\`</span><span style="color:#E1E4E8;">, realWidth, Math.</span><span style="color:#B392F0;">floor</span><span style="color:#E1E4E8;">(minX));</span></span>
<span class="line"><span style="color:#E1E4E8;">          console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`realHeight----&gt;\`</span><span style="color:#E1E4E8;">, realHeight, Math.</span><span style="color:#B392F0;">floor</span><span style="color:#E1E4E8;">(minY));</span></span>
<span class="line"><span style="color:#E1E4E8;">          canvas.width </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> realWidth </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> dpr </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> padding </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">          canvas.height </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> realHeight </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> dpr </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> padding </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">          canvas.style.width </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> realWidth </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;px&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">          canvas.style.height </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> realHeight </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;px&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">translate</span><span style="color:#E1E4E8;">(padding, padding); </span><span style="color:#6A737D;">// å°†åæ ‡è½´åŸç‚¹ç§»åŠ¨åˆ°ï¼ˆ20, 20ï¼‰</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">scale</span><span style="color:#E1E4E8;">(dpr, dpr);</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.strokeStyle </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;red&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡é¢œè‰²</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.lineWidth </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡å®½åº¦</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.lineJoin </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;round&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡è¿æ¥å¤„çš„æ ·å¼</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.lineCap </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;round&#39;</span><span style="color:#E1E4E8;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡æœ«ç«¯çš„æ ·å¼</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">moveTo</span><span style="color:#E1E4E8;">(realPoints[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">].x, realPoints[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">].y); </span><span style="color:#6A737D;">// å°†ç”»ç¬”ç§»åŠ¨åˆ°èµ·å§‹ç‚¹</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">let</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">; i </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> realPoints.</span><span style="color:#79B8FF;">length</span><span style="color:#E1E4E8;">; i</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#6A737D;">// å–ç»ˆç‚¹ï¼Œå°†ä¸Šä¸€ä¸ªç‚¹ä½œä¸ºæ§åˆ¶ç‚¹ï¼Œå¹³æ»‘è¿‡æ¸¡</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">cx</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (realPoints[i].x </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> realPoints[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].x) </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">cy</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (realPoints[i].y </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> realPoints[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].y) </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">              ctxContent.</span><span style="color:#B392F0;">quadraticCurveTo</span><span style="color:#E1E4E8;">(realPoints[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].x, realPoints[i </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">].y, cx, cy);</span></span>
<span class="line"><span style="color:#E1E4E8;">          }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">stroke</span><span style="color:#E1E4E8;">(); </span><span style="color:#6A737D;">// ç”»çº¿</span></span>
<span class="line"><span style="color:#E1E4E8;">          ctxContent.</span><span style="color:#B392F0;">restore</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">          console.</span><span style="color:#B392F0;">log</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">\`canvas---&gt;\`</span><span style="color:#E1E4E8;">, canvas.</span><span style="color:#B392F0;">toDataURL</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">          elementWithCanvasCache.</span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;">(points, {</span></span>
<span class="line"><span style="color:#E1E4E8;">              canvas,</span></span>
<span class="line"><span style="color:#E1E4E8;">              realPoints,</span></span>
<span class="line"><span style="color:#E1E4E8;">              x: minX </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> dpr </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> padding,</span></span>
<span class="line"><span style="color:#E1E4E8;">              y: minY </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> dpr </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;"> padding</span></span>
<span class="line"><span style="color:#E1E4E8;">          });</span></span>
<span class="line"><span style="color:#E1E4E8;">      }</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">script</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getBoundsFromPoints</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">points</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> minX </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Infinity</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> minY </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Infinity</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> maxX </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">Infinity</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> maxY </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">Infinity</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">x</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">y</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">of</span><span style="color:#24292E;"> points) {</span></span>
<span class="line"><span style="color:#24292E;">            minX </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Math.</span><span style="color:#6F42C1;">min</span><span style="color:#24292E;">(minX, x);</span></span>
<span class="line"><span style="color:#24292E;">            minY </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Math.</span><span style="color:#6F42C1;">min</span><span style="color:#24292E;">(minY, y);</span></span>
<span class="line"><span style="color:#24292E;">            maxX </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Math.</span><span style="color:#6F42C1;">max</span><span style="color:#24292E;">(maxX, x);</span></span>
<span class="line"><span style="color:#24292E;">            maxY </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Math.</span><span style="color:#6F42C1;">max</span><span style="color:#24292E;">(maxY, y);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> [minX, minY, maxX, maxY];</span></span>
<span class="line"><span style="color:#24292E;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">/*</span></span>
<span class="line"><span style="color:#6A737D;">      1 è·å–å½“å‰å…ƒç´ çš„åæ ‡ï¼Œç›¸å¯¹äºç¦»å± Canvas çš„åæ ‡</span></span>
<span class="line"><span style="color:#6A737D;">      2 è·å– Canvas çš„å®½é«˜</span></span>
<span class="line"><span style="color:#6A737D;">      */</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getElementAbsoluteCoords</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">points</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> [</span><span style="color:#005CC5;">minX</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">minY</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">maxX</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">maxY</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getBoundsFromPoints</span><span style="color:#24292E;">(points);</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">width</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> maxX </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> minX;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">height</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> maxY </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> minY;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">              minX,</span></span>
<span class="line"><span style="color:#24292E;">              minY,</span></span>
<span class="line"><span style="color:#24292E;">              width,</span></span>
<span class="line"><span style="color:#24292E;">              height,</span></span>
<span class="line"><span style="color:#24292E;">              points: points.</span><span style="color:#6F42C1;">map</span><span style="color:#24292E;">(({ </span><span style="color:#E36209;">x</span><span style="color:#24292E;">, </span><span style="color:#E36209;">y</span><span style="color:#24292E;"> }) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> ({ x: Math.</span><span style="color:#6F42C1;">round</span><span style="color:#24292E;">(x </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> minX), y: Math.</span><span style="color:#6F42C1;">round</span><span style="color:#24292E;">(y </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> minY) })) </span><span style="color:#6A737D;">// è·å–å½“å‰å…ƒç´ çš„åæ ‡ï¼Œç›¸å¯¹äºç¦»å± Canvas çš„åæ ‡</span></span>
<span class="line"><span style="color:#24292E;">          };</span></span>
<span class="line"><span style="color:#24292E;">      };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generateOffScreenCanvas</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">points</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">canvas</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">createElement</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;canvas&#39;</span><span style="color:#24292E;">); </span><span style="color:#6A737D;">// åˆ›å»ºä¸€ä¸ªç¦»å± Canvas</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ctxContent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> canvas.</span><span style="color:#6F42C1;">getContext</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;2d&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">save</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#6A737D;">// è·å–æœ€å°çš„ç‚¹å’Œæœ€å¤§çš„ç‚¹</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">minX</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">minY</span><span style="color:#24292E;">, </span><span style="color:#E36209;">width</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">realWidth</span><span style="color:#24292E;">, </span><span style="color:#E36209;">height</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">realHeight</span><span style="color:#24292E;">, </span><span style="color:#E36209;">points</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">realPoints</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getElementAbsoluteCoords</span><span style="color:#24292E;">(points);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">          console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`realWidth----&gt;\`</span><span style="color:#24292E;">, realWidth, Math.</span><span style="color:#6F42C1;">floor</span><span style="color:#24292E;">(minX));</span></span>
<span class="line"><span style="color:#24292E;">          console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`realHeight----&gt;\`</span><span style="color:#24292E;">, realHeight, Math.</span><span style="color:#6F42C1;">floor</span><span style="color:#24292E;">(minY));</span></span>
<span class="line"><span style="color:#24292E;">          canvas.width </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> realWidth </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> dpr </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> padding </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">          canvas.height </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> realHeight </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> dpr </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> padding </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">          canvas.style.width </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> realWidth </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;px&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">          canvas.style.height </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> realHeight </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;px&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">translate</span><span style="color:#24292E;">(padding, padding); </span><span style="color:#6A737D;">// å°†åæ ‡è½´åŸç‚¹ç§»åŠ¨åˆ°ï¼ˆ20, 20ï¼‰</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">scale</span><span style="color:#24292E;">(dpr, dpr);</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.strokeStyle </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;red&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡é¢œè‰²</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.lineWidth </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡å®½åº¦</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.lineJoin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;round&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡è¿æ¥å¤„çš„æ ·å¼</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.lineCap </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;round&#39;</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// è®¾ç½®çº¿æ¡æœ«ç«¯çš„æ ·å¼</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">moveTo</span><span style="color:#24292E;">(realPoints[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].x, realPoints[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].y); </span><span style="color:#6A737D;">// å°†ç”»ç¬”ç§»åŠ¨åˆ°èµ·å§‹ç‚¹</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">let</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">; i </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> realPoints.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">; i</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#6A737D;">// å–ç»ˆç‚¹ï¼Œå°†ä¸Šä¸€ä¸ªç‚¹ä½œä¸ºæ§åˆ¶ç‚¹ï¼Œå¹³æ»‘è¿‡æ¸¡</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cx</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (realPoints[i].x </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> realPoints[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].x) </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">cy</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (realPoints[i].y </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> realPoints[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].y) </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">              ctxContent.</span><span style="color:#6F42C1;">quadraticCurveTo</span><span style="color:#24292E;">(realPoints[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].x, realPoints[i </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].y, cx, cy);</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">stroke</span><span style="color:#24292E;">(); </span><span style="color:#6A737D;">// ç”»çº¿</span></span>
<span class="line"><span style="color:#24292E;">          ctxContent.</span><span style="color:#6F42C1;">restore</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">          console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">\`canvas---&gt;\`</span><span style="color:#24292E;">, canvas.</span><span style="color:#6F42C1;">toDataURL</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">          elementWithCanvasCache.</span><span style="color:#6F42C1;">set</span><span style="color:#24292E;">(points, {</span></span>
<span class="line"><span style="color:#24292E;">              canvas,</span></span>
<span class="line"><span style="color:#24292E;">              realPoints,</span></span>
<span class="line"><span style="color:#24292E;">              x: minX </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> dpr </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> padding,</span></span>
<span class="line"><span style="color:#24292E;">              y: minY </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> dpr </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> padding</span></span>
<span class="line"><span style="color:#24292E;">          });</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">script</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><h2 id="å®ç°çš„æ•ˆæœ" tabindex="-1">å®ç°çš„æ•ˆæœ <a class="header-anchor" href="#å®ç°çš„æ•ˆæœ" aria-label="Permalink to &quot;å®ç°çš„æ•ˆæœ&quot;">â€‹</a></h2><p><img src="`+p+'" alt="canvas"></p><h2 id="å…·ä½“ä»£ç " tabindex="-1">å…·ä½“ä»£ç  <a class="header-anchor" href="#å…·ä½“ä»£ç " aria-label="Permalink to &quot;å…·ä½“ä»£ç &quot;">â€‹</a></h2><p><a href="https://github.com/enson0131/learn/blob/main/Canvas/%E7%99%BD%E6%9D%BF%E7%9B%B8%E5%85%B3/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E4%B9%8B%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93%E5%8F%8A%E7%BC%93%E5%AD%98.html" target="_blank" rel="noreferrer">https://github.com/enson0131/learn/blob/main/Canvas/ç™½æ¿ç›¸å…³/æ€§èƒ½ä¼˜åŒ–ä¹‹ç¦»å±æ¸²æŸ“åŠç¼“å­˜.html</a></p>',19),t=[e];function c(r,E,y,i,F,C){return n(),a("div",null,t)}const h=s(o,[["render",c]]);export{D as __pageData,h as default};
